{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block content %}

<!-- ================= TASK LIST ================= -->
<div class="card">
    <h2>
        {% if selected_priority != 'All' %}
            {{ selected_priority }} Priority Tasks
        {% else %}
            My To-Do List
        {% endif %}
    </h2>

    <!-- Priority Filter -->
    <li>
        <form action="/" method="get">
            <select name="priority" onchange="this.form.submit()">
                <option value="All">All Priorities</option>
                <option value="High" {% if selected_priority == 'High' %}selected{% endif %}>High</option>
                <option value="Medium" {% if selected_priority == 'Medium' %}selected{% endif %}>Medium</option>
                <option value="Low" {% if selected_priority == 'Low' %}selected{% endif %}>Low</option>
            </select>
        </form>
    </li>
    
    <ul>
        {% for task in tasks %}
        <li>
            <div>
                <a href="/task/{{ task.id }}">{{ task.title }}</a><br>
                <small>
                    Priority: {{ task.priority }} |
                    Due: {{ task.due_date }}
                </small>
            </div>

            {% if task.status == 'Completed' %}
                <span class="status status-completed">Completed</span>
            {% elif task.status == 'In Progress' %}
                <span class="status status-in-progress">In Progress</span>
            {% else %}
                <span class="status status-planned">Pending</span>
            {% endif %}
        </li>
        {% else %}
        <li>No tasks found.</li>
        {% endfor %}
    </ul>
</div>

<!-- ================= DASHBOARD ================= -->
<div class="card">
    <h2>Task Dashboard</h2>

    <div class="task-grid">
        <div class="task-card">
            <h3>Total Tasks</h3>
            <p>{{ total }}</p>
        </div>

        <div class="task-card">
            <h3>Completed</h3>
            <p class="status status-completed">{{ completed }}</p>
        </div>

        <div class="task-card">
            <h3>In Progress</h3>
            <p class="status status-in-progress">{{ in_progress }}</p>
        </div>

        <div class="task-card">
            <h3>Pending</h3>
            <p class="status status-planned">{{ pending }}</p>
        </div>
    </div>
</div>

{% endblock %}
